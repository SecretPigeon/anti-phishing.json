# anti-phishing.json
> Proposal to close email security gaps enabling phishing by use of a well-known URI

Reliance on heuristic filters and end user training, has only resulted in phishing attacks becoming increasingly sophisticated. Good phishing attacks now often look more genuine than emails actually from my bank. They are more likely to have good grammar, meet my banks security guidelines and have a dkim signature from a sensible domain than the genuine emails. 

Although DKIM and DMARC have provided partial solutions, they don't mandate organisations sign emails from their primary domain. Leaving users guessing if the signed-by domain is a 3rd party or a phishing attack. They also do nothing to address the issue of valid signatures from look-a-like domains using techniques such as typosquatting or homograph attacks.

## Premise
It's my observation that people see the following categories of email in their inboxâ€™s: -
 * Person to Person (Emails from friends and colleagues)
 * Unsolicited Organisation to Person (Spam)
 * Solicited Organisation to Person (Online banking, Website signups)

And it's my position, that the 3rd case "Solicited Organisation to Person" is at the biggest risk of phishing. That is because this category includes our financial interactions, our social media accounts and any interactions with websites that could result in account compromise.

Although email between Organisations and users is not considered a secure channel. There does exist a well establish channel that is already accepted as secure by most end users, organisations and experts; that being websites. A website with TLS and a CA signed certificate, is already considered sufficiently secure for online banking, payments, taxes and government services. Most business to user communications are simply links bank to the website that a user signed up to or has an existing relationship with.

## Workflow

### Permissive
 1. No setup is required
 2. Emails from an organisation are validated as from their primary website if and only if a dkim signature is valid and is from a domain allowed by anti-phishing.json on the primary site.. 
 
For example emails from: "alice@example.com" but signed by "example.net" are validated as from "example.com" if and only if "example.net" is an authorised sender in "https://example.com/.well-known/anti-phishing.json".

### Strict
 1. User goes to organisation website and verifies the website certificate
 2. The users browser or extension is used to help users subscribe to emails from this website (and this organisation)
 3. Emails from this organisation are validated as from the subscribed website and cannot be phished using either the associated domain or a similar domain name. 
 
In this workflow, similar domain name attacks are prevented as only subscribed domains pass validation.

### User Content
 1. An email is received from a subscribed domain. It's a genuine autogenerated email which passes validation.
 2. The email contains a link to a user-controlled path (such as a user uploaded html document in dropbox)
 3. The user opens the link and is prompted for their username and password.
 4. The users browser detects (using anti-phishing.json) the likely phishing attack and protects the user.

## Mechanism
We propose a well-known uri ".well-known/anti-phishing.json", browsers look for this file on every visited website. When the user is prompted for an email address. A browser knows to check "anti-phishing.json" to ensure the page is not user generated content and then to prompt the user to allow the website to send them verified email. Once a user is subscribed they can receive verified emails from both the website and people at that organisation. Emails received show as "from:user@example.com" verified as "example.com".

The json file contains the following key fields:
 * dkim_domains - Domains which can sign emails from this website (often shown as "via" in email clients)
 * email_domains - Allowed fields in from address
 * user_content - Uri's that contain user content and should not be used for authentication.
 * auth_uri - A white list of uri(s) which can authenticate users
 * www_domains - Domains allowed to host images used in emails from this domain
 

## Examples
Please see examples folder
 * [Example.com](draft-1.0/examples/example.json) A generic example with annotations
 * [Dropbox.com](draft-1.0/examples/dropbox.com) A Real-world example based on dropbox
