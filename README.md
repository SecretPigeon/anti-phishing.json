# anti-phishing.json
> Proposal to close email security gaps enabling phishing by use of a well-known URI
Reliance on heuristic filters and end user training has only resulted in phishing attacks becoming increasingly sophisticated. Good phishing attacks often look more genuine than emails from genuine organisations. Having good grammar, meeting security guidelines and have a dkim signature from a familiar domain. 

Although DKIM and DMARC have provided partial solutions, they don't mandate organisations sign emails from their primary domain. Leaving users guessing. No current mechanism addresses the issue of valid signatures from look-a-like domains using techniques such as typosquatting or homograph attacks.

## Premise
It's my observation that people see the following categories of email in their inbox’s: -
 * Person to Person (Emails from friends and colleagues)
 * Unsolicited Organisation to Person (Spam)
 * Solicited Organisation to Person (Online banking, Website signups)
* Person to Organisation (Email to case)
It's my position, that it’s the 3rd case "Solicited Organisation to Person" that is the biggest risk of phishing. That is because this category includes our financial interactions, our social media accounts and interactions with websites that could result in account compromise.
Although email between organisations and users is not yet secure channel. There exists a well establish channel that is secure. A website with TLS and CA issued certificate is already considered sufficiently secure for banking, online payments, taxes and government services. 
## Workflow
### Permissive
 1. No setup is required
 2. Emails from an organisation are validated as from their primary website if and only if a dkim signature is valid and is from a domain listed in anti-phishing.json on the primary site. 
For example emails from: "alice@example.com" but signed by "example.net" are validated as from "example.com" if and only if "example.net" is an authorised sender in "https://example.com/.well-known/anti-phishing.json".
### Strict
 1. User goes to organisation website and verifies the website certificate
 2. The users browser or extension is used to help users subscribe to emails from this website (and this organisation)
 3. Emails from this organisation are validated as from the subscribed website and cannot be phished using either the associated domain or a similar domain name. Similar domain name attacks are prevented as only subscribed domains pass validation.

### User Content
 1. An email is received from a subscribed domain. It's a genuine autogenerated email which passes validation.
 2. The email contains a link to a user-controlled path (such as a user uploaded html document in dropbox)
 3. The user opens the link and is prompted for their username and password.
 4. The users browser detects (using anti-phishing.json) the likely phishing attack and protects the user.
### User shared links
1.	A user wants to share a link with a friend either by email or via social media
2.	The user requests a signed link from the target domain (example.com)
3.	Example.com signs the link with their private key.
4.	The friend receives the link and their browser validates the link using the public key found in anti-phishing.json

## Mechanism
We propose a well-known uri ".well-known/anti-phishing.json", browsers look for this file on every visited website. When the user is prompted for an email address. A browser knows to check "anti-phishing.json" to ensure the page is not user generated content and then to prompt the user to allow the website to send them verified email. Once a user is subscribed they can receive verified emails from both the website and people at that organisation. Emails received show as "from:user@example.com" verified as "example.com".

The json file contains the following key fields:
 * dkim_domains - Domains which can sign emails from this website (often shown as "via" in email clients)
 * email_domains - Allowed fields in from address
 * user_content - Uri's that contain user content and should not be used for authentication.
 * auth_uri - A white list of uri(s) which can authenticate users
 * www_domains - Domains allowed to host images used in emails from this domain
* signatures – Hash of signing algorithms and public keys used to validate signed links
 

## Examples
Please see examples folder
 * [Example.com](draft-1.0/examples/example.json) A generic example with annotations
 * [Dropbox.com](draft-1.0/examples/dropbox.json) A Real-world example based on dropbox
